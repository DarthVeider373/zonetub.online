<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deepfinds - Phone Number</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- libphonenumber-js for proper phone validation -->
  <script src="js/libphonenumber-min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            "deeplinks-primary": "#e53e3e",
            "deeplinks-secondary": "#ffd700",
            "deeplinks-text": "#2d3748",
            "deeplinks-muted": "#a0aec0",
            "deeplinks-bg": "#f7fafc",
            "deeplinks-card": "#ffffff",
          },
        },
      },
    };
  </script>
  <script src="js/latest.js" data-utmify-prevent-xcod-sck="" data-utmify-prevent-subids="" async="" defer=""></script>
  <style>
    @keyframes slideInFromRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .live-feed-item {
      animation: slideInFromRight 0.5s ease-out;
    }
  </style>
</head>

<body class="min-h-screen bg-gray-50">
  <div class="max-w-4xl mx-auto px-4 py-8">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-800 mb-4">
        ðŸŽ‰ Congratulations! Your FREE access is unlocked
      </h1>
      <p class="text-gray-500 text-lg">
        Complete the form below to begin the comprehensive scan of your
        partner's digital footprint.
      </p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Phone Number Form -->
      <div class="bg-white rounded-2xl p-8 border border-gray-200">
        <h2 class="text-2xl font-semibold text-gray-800 mb-6">
          Target Phone Number
        </h2>

        <form onsubmit="handleSubmit(event)" class="space-y-6">
          <!-- Country Selection -->
          <div>
            <label for="country" class="block text-sm font-medium text-gray-800 mb-2">
              Country
            </label>
            <select id="country" onchange="handleCountryChange()" class="w-full px-3 py-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 text-lg bg-white">
              <option value="US">ðŸ‡ºðŸ‡¸ United States (+1)</option>
              <option value="BR">ðŸ‡§ðŸ‡· Brazil (+55)</option>
              <option value="GB">ðŸ‡¬ðŸ‡§ United Kingdom (+44)</option>
              <option value="CA">ðŸ‡¨ðŸ‡¦ Canada (+1)</option>
              <option value="FR">ðŸ‡«ðŸ‡· France (+33)</option>
              <option value="DE">ðŸ‡©ðŸ‡ª Germany (+49)</option>
              <option value="ES">ðŸ‡ªðŸ‡¸ Spain (+34)</option>
              <option value="IT">ðŸ‡®ðŸ‡¹ Italy (+39)</option>
              <option value="MX">ðŸ‡²ðŸ‡½ Mexico (+52)</option>
              <option value="AR">ðŸ‡¦ðŸ‡· Argentina (+54)</option>
            </select>
            <p class="text-sm text-gray-500 mt-2">
              Select the country for the phone number
            </p>
          </div>

          <!-- Phone Number Input -->
          <div>
            <label for="phone" class="block text-sm font-medium text-gray-800 mb-2">
              Phone Number
            </label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <span id="country-flag" class="text-gray-500 text-sm">ðŸ‡ºðŸ‡¸ +1</span>
              </div>
              <input type="tel" id="phone" oninput="handlePhoneChange()" placeholder="(555) 123-4567" class="w-full pl-16 pr-3 py-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 text-lg" maxlength="20">
            </div>
            <p class="text-sm text-gray-500 mt-2">
              Enter the phone number you want to monitor
            </p>
          </div>

          <div id="error-message" class="hidden bg-red-50 border border-red-200 rounded-lg p-4">
            <p class="text-red-600 text-sm"></p>
          </div>

          <button type="submit" id="submit-btn" disabled="" class="w-full bg-red-600 text-white py-4 px-6 rounded-lg font-semibold text-lg disabled:opacity-50 disabled:cursor-not-allowed transition-opacity cursor-pointer">
            <span id="submit-text">Expose Everything Now</span>
            <div id="loading-spinner" class="hidden flex items-center justify-center">
              <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
              Scanning...
            </div>
          </button>
        </form>
      </div>

      <!-- Live Activity Feed -->
      <div class="bg-white rounded-2xl p-8 border border-gray-200">
        <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
          <span class="text-yellow-500 mr-2">ðŸ”¥</span>
          Live Activity Feed
        </h2>

        <div id="live-activities" class="space-y-4 max-h-96 overflow-y-auto">
          <div class="text-center py-8">
            <div class="animate-pulse">
              <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
              <div class="h-4 bg-gray-200 rounded w-1/2 mx-auto"></div>
            </div>
            <p class="text-gray-500 text-sm mt-4">
              Live activities will appear here...
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Security Notice -->
    <div class="mt-8 bg-white rounded-2xl p-6 border border-gray-200">
      <div class="flex items-start space-x-3">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
            <span class="text-blue-600 text-sm">ðŸ”’</span>
          </div>
        </div>
        <div>
          <h3 class="font-semibold text-gray-800 mb-2">
            Secure & Confidential
          </h3>
          <p class="text-sm text-gray-500">
            All data is encrypted and processed through secure channels. Your
            information is never shared with third parties.
          </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const countryMasks = {
      US: {
        mask: "(999) 999-9999",
        placeholder: "(555) 123-4567",
        code: "+1",
        flag: "ðŸ‡ºðŸ‡¸",
      },
      BR: {
        mask: "(99) 99999-9999",
        placeholder: "(11) 99999-9999",
        code: "+55",
        flag: "ðŸ‡§ðŸ‡·",
      },
      GB: {
        mask: "9999 999 9999",
        placeholder: "7911 123456",
        code: "+44",
        flag: "ðŸ‡¬ðŸ‡§",
      },
      CA: {
        mask: "(999) 999-9999",
        placeholder: "(416) 555-0123",
        code: "+1",
        flag: "ðŸ‡¨ðŸ‡¦",
      },
      FR: {
        mask: "99 99 99 99 99",
        placeholder: "06 12 34 56 78",
        code: "+33",
        flag: "ðŸ‡«ðŸ‡·",
      },
      DE: {
        mask: "999 99999999",
        placeholder: "030 12345678",
        code: "+49",
        flag: "ðŸ‡©ðŸ‡ª",
      },
      ES: {
        mask: "999 99 99 99",
        placeholder: "612 34 56 78",
        code: "+34",
        flag: "ðŸ‡ªðŸ‡¸",
      },
      IT: {
        mask: "999 999 9999",
        placeholder: "320 123 4567",
        code: "+39",
        flag: "ðŸ‡®ðŸ‡¹",
      },
      MX: {
        mask: "99 9999 9999",
        placeholder: "55 1234 5678",
        code: "+52",
        flag: "ðŸ‡²ðŸ‡½",
      },
      AR: {
        mask: "99 9999-9999",
        placeholder: "11 1234-5678",
        code: "+54",
        flag: "ðŸ‡¦ðŸ‡·",
      },
    };

    const mockActivities = [
      {
        id: "1",
        message:
          "Sarah M. from New York just discovered her boyfriend's secret Instagram account",
        timestamp: "2 minutes ago",
        type: "success",
      },
      {
        id: "2",
        message:
          "Mike R. from California found 47 deleted messages on his girlfriend's phone",
        timestamp: "5 minutes ago",
        type: "warning",
      },
      {
        id: "3",
        message:
          "Jessica L. from Texas uncovered hidden dating apps on her partner's device",
        timestamp: "8 minutes ago",
        type: "info",
      },
      {
        id: "4",
        message:
          "David K. from Florida discovered secret location data from last weekend",
        timestamp: "12 minutes ago",
        type: "success",
      },
      {
        id: "5",
        message:
          "Amanda S. from Illinois found evidence of late-night calls to unknown numbers",
        timestamp: "15 minutes ago",
        type: "warning",
      },
    ];

    let liveActivities = [];
    let activityIndex = 0;

    window.onload = function () {
      const storedGender = localStorage.getItem("deeplinks-gender");
      if (!storedGender) {
        window.location.href = "/spy/pag1/";
      }
    };


    // Start live activity feed
    startLiveActivityFeed();;

    function startLiveActivityFeed() {
      const interval = setInterval(() => {
        if (activityIndex < mockActivities.length) {
          const activity = mockActivities[activityIndex];
          liveActivities.push(activity);
          updateLiveActivities();
          activityIndex++;
        } else {
          clearInterval(interval);
        }
      }, 3000);
    }

    function updateLiveActivities() {
      const container = document.getElementById("live-activities");
      container.innerHTML = "";

      liveActivities.forEach((activity, index) => {
        const activityDiv = document.createElement("div");
        activityDiv.className = `live-feed-item p-4 rounded-lg border-l-4 ${activity.type === "success"
          ? "border-green-500 bg-green-50"
          : activity.type === "warning"
            ? "border-yellow-500 bg-yellow-50"
            : "border-blue-500 bg-blue-50"
          }`;
        activityDiv.style.animationDelay = `${index * 0.1}s`;

        activityDiv.innerHTML = `
                    <p class="text-sm text-gray-800 font-medium">${activity.message}</p>
                    <p class="text-xs text-gray-500 mt-1">${activity.timestamp}</p>
                `;

        container.appendChild(activityDiv);
      });
    }

    function handleCountryChange() {
      const country = document.getElementById("country").value;
      const countryData = countryMasks[country];
      document.getElementById(
        "country-flag"
      ).textContent = `${countryData.flag} ${countryData.code}`;
      document.getElementById("phone").placeholder = countryData.placeholder;
      document.getElementById("phone").value = "";
    }

    function formatPhoneNumber(value, mask) {
      if (!value) return value;
      const phoneNumber = value.replace(/[^\d]/g, "");
      let formattedNumber = "";
      let phoneIndex = 0;

      for (
        let i = 0;
        i < mask.length && phoneIndex < phoneNumber.length;
        i++
      ) {
        if (mask[i] === "9") {
          formattedNumber += phoneNumber[phoneIndex];
          phoneIndex++;
        } else {
          formattedNumber += mask[i];
        }
      }
      return formattedNumber;
    }

    function handlePhoneChange() {
      const country = document.getElementById("country").value;
      const countryData = countryMasks[country];
      const input = document.getElementById("phone");
      const formatted = formatPhoneNumber(input.value, countryData.mask);
      input.value = formatted;

      // Enable/disable submit button with proper validation
      const phoneDigits = input.value.replace(/\D/g, "");
      const isValid = validatePhoneNumber(input.value, country);
      document.getElementById("submit-btn").disabled = !isValid;

      // Hide error when typing
      if (isValid) {
        hideError();
      }
    }

    function validatePhoneNumber(phoneNumber, country) {
      try {
        const phoneDigits = phoneNumber.replace(/\D/g, "");

        // Use libphonenumber-js to validate the actual phone number
        const countryData = countryMasks[country];
        const fullNumber = countryData.code + phoneDigits;

        // Parse and validate using libphonenumber-js
        const phoneNumberObj = libphonenumber.parsePhoneNumber(
          fullNumber,
          country
        );

        // Check if the number is valid and belongs to the selected country
        return (
          phoneNumberObj &&
          phoneNumberObj.isValid() &&
          phoneNumberObj.country === country
        );
      } catch (error) {
        // If parsing fails, the number is invalid
        return false;
      }
    }

    function showError(message) {
      const errorDiv = document.getElementById("error-message");
      const errorText = errorDiv.querySelector("p");
      errorText.textContent = message;
      errorDiv.classList.remove("hidden");
    }

    function hideError() {
      document.getElementById("error-message").classList.add("hidden");
    }

    async function handleSubmit(e) {
      e.preventDefault();

      const phoneNumber = document.getElementById("phone").value;
      const country = document.getElementById("country").value;

      if (!phoneNumber || !validatePhoneNumber(phoneNumber, country)) {
        showError(
          "Please enter a valid phone number for the selected country"
        );
        return;
      }

      // Show loading state
      document.getElementById("submit-text").classList.add("hidden");
      document.getElementById("loading-spinner").classList.remove("hidden");
      document.getElementById("submit-btn").disabled = true;
      hideError();

      try {
        // Simulate scanning process
        await new Promise((resolve) => setTimeout(resolve, 2000));

        // Get country code and clean phone number
        const countryData = countryMasks[country];
        const cleanedPhone = phoneNumber.replace(/\D/g, ""); // Remove all non-digits
        const fullPhoneNumber = `${countryData.code}${cleanedPhone}`; // Add country code

        console.log("Original input:", phoneNumber);
        console.log("Country code:", countryData.code);
        console.log("Cleaned phone:", cleanedPhone);
        console.log("Full phone with country code:", fullPhoneNumber);

        // Store full phone number with country code in localStorage
        localStorage.setItem("deeplinks-phone", fullPhoneNumber);

        // Redirect to page2
        window.location.href = "./pag2/";
      } catch (error) {
        showError("An error occurred. Please try again.");
        document.getElementById("submit-text").classList.remove("hidden");
        document.getElementById("loading-spinner").classList.add("hidden");
        document.getElementById("submit-btn").disabled = false;
      }
    }
  </script>


</body>

</html>